gpu kernel 和纯粹的cpu实现不太一致.

因为gpu需要使用cuda代码, 然后将cuda代码包装起来.
